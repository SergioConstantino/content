category: Analytics & SIEM
commonfields:
  id: KnowBe4 KMSAT Event Collector
  version: -1
configuration:
- defaultvalue: https://api.events.knowbe4.com
  display: Your server URL
  name: url
  required: true
  type: 15
  options:
  - https://api.events.knowbe4.com
  - https://api-eu.events.knowbe4.com
- displaypassword: API Key
  additionalinfo: The API Key to use for connection
  name: credentials
  required: true
  hiddenusername: true
  type: 9
- additionalinfo: The time range to consider for the initial data fetch. (<number>
    <unit>, e.g., 2 minutes, 2 hours, 2 days, 2 months, 2 years). Default is 1 day.
  defaultvalue: 1 day
  display: First fetch time interval
  hidden: false
  name: first_fetch
  required: false
  type: 0
- additionalinfo: The Fetch interval, it's recommended to set it to 5 hours 
    as there're not much events for this api and there's a 10 call daily-limit for basic api key.
  defaultvalue: 300
  display: Events Fetch Interval
  hidden: false
  name: eventFetchInterval
  required: false
  type: 19
- display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8
- display: The vendor corresponding to the integration that produced the events.
  name: vendor
  type: 0
  defaultvalue: knowbe4
  hidden: true
- display: The product corresponding to the integration that produced the events.
  name: product
  type: 0
  defaultvalue: kmsat
  hidden: true
  required: false
description: '[Enter a comprehensive, yet concise, description of what the integration does, what use cases it is designed for, etc.]'
display: 'KnowBe4 KMSAT Event Collector'
name: KnowBe4 KMSAT Event Collector
script:
  commands:
  - deprecated: false
    description: Manual command to fetch events and display them.
    execution: false
    name: kms-get-events
    arguments:
      - name: occurred_date
        description: Filter by Occurred Date (YYYY-MM-DD).
      - name: risk_level
        description: Filter by Risk Level by entering a value from -10 (low risk) to 10 (high risk).
      - name: per_page
        description: How many results to bring per page (the max & default is 100).
      - name: page
        description: Which results page to bring.
      - auto: PREDEFINED
        defaultValue: 'False'
        description: Set this argument to True in order to create events, otherwise the command will only display them. *If setting to 'False' The returned events will be lost.*
        isArray: false
        name: should_push_events
        predefined:
          - 'True'
          - 'False'
        required: true
    outputs:
    - contextPath: KMSat.Event.id
      description: Event id.
      type: Number
    - contextPath: KMSat.Event.user.email
      description: The target mail for this event.
      type: String
    - contextPath: KMSat.Event.user.id
      description: The id of the user the event is targeted to.
      type: Number
    - contextPath: KMSat.Event.user.archived
      description: Whether the user is archived or not.
      type: Boolean
    - contextPath: KMSat.Event.external_id
      description: The event's external id.
      type: String
    - contextPath: KMSat.Event.source
      description: The source of the event.
      type: String
    - contextPath: KMSat.Event.description
      description: The event description.
      type: String
    - contextPath: KMSat.Event.occurred_date
      description: The date the event occurred.
      type: String
    - contextPath: KMSat.Event.risk.level
      description: The event's risk level.
      type: Number
    - contextPath: KMSat.Event.risk.factor
      description: The event's risk factor.
      type: Number
    # - contextPath: KMSat.Event.risk.decay_mode
    #   description: 
    #   type: String
    - contextPath: KMSat.Event.risk.expire_date
      description: The event's expire date.
      type: String
    - contextPath: KMSat.Event.event_type.id
      description: The id of the event type.
      type: Number
    - contextPath: KMSat.Event.event_type.name
      description: The name of the event type.
      type: String
  isfetch: false
  runonce: false
  script: '-'
  type: python
  subtype: python3
  dockerimage: demisto/python3:3.10.5.31797
  isfetchevents: true
fromversion: 6.8.0
tests:
- No tests (auto formatted)
marketplaces:
- marketplacev2